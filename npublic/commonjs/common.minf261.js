"use strict";var smsFlag=!1,smsShowFun=null,hasScroll=!1,isWeixin=function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)};function accessLimit(){var e,t,n,a,i;isFrontEnv()&&location.hostname==tenant.domain&&(e=tenant.XSKey,t=localStorage.getItem("kt"+tenant.tenantId),n=+new Date,!isNaN(Number(t))&&36e5<n-Number(t)&&localStorage.removeItem("kt"+tenant.tenantId),e&&!t&&(a=e[9],i=e[10],"1"!=a&&"1"!=i||$require(["cmsAjax","/npublic/commonjs/jsencrypt.js"],function(t,e){var n=$.nrsa("designVue&".concat(+new Date),"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCdBbSMUKBY3wW8C/RFFwFoTHyO8xM67xBtgERb/4z6dqUq2ZeTagHUT6tbnuvhug0FNU9t/bzBc6KOivkzPToYYJG/RDzvdAJTjdvvvu3WQUpKOa0s0V3ehkKRoZPIFw3YnahtUrIe9es0V0LlTkOyFlH2M6rpceC7K0XgEs7lZwIDAQAB");t.cmsAjax.get("/fwebapi/visitor/lowcode/designToken/getToken",{},{headers:{authCode:n}}).then(function(e){try{t.cmsAjax.get("/fwebapi/visitor/lowcode/designToken/getI",{},{headers:{token:e.data.token}}).then(function(e){("1"==e.data.status&&"1"==a||"2"==e.data.status&&"1"==i)&&(location.href="/npublic/plugins/accessLimit/index.html")})}catch(e){}})})))}function getmeta(e){for(var t,n=document.getElementsByTagName("meta"),a=0;t=n[a++];)if(t.getAttribute("name")&&t.getAttribute("name").toLowerCase()===e)return encodeURIComponent(t.content)}function gray(){$require(["cmsAjax"],function(e){var t=window.location.origin+"/ndesigner/api/gray";e.cmsAjax.postJson(t).then(function(e){200==e.code&&($("html")[0].style="filter:progid:DXImageTransform.Microsoft.Basiclmage(grayscale=1);-webkit-filter:grayscale(100%);")})})}function festival(){isFrontEnv()&&$require(["cmsAjax"],function(e){e.cmsAjax.get("/fwebapi/cms/lowcode/festivalPendant/getSettings").then(function(e){var t;e.data&&200==e.data.code&&e.data.settings&&(1==(t=e.data.settings).location&&window.pageObj&&1!=window.pageObj.isHomePage||(e=t.showTime&&2==t.showTime.length&&t.nowTime>=t.showTime[0]&&t.nowTime<=t.showTime[1]||!t.showTime||0==t.showTime.length,t.isOpen&&e&&$require(["/npublic/commonjs/restival.js"],function(e){e.init(t)})))})})}function smartServiceInit(){isFrontEnv()&&$(window).on("mousemove scroll touchmove tap click keydown",function(){hasScroll||(hasScroll=!0,$require(["cmsAjax","pl_util"],function(e){var t=$.getSearch(),a=__ce.smartServiceUrl||"https://web-visitor.yun300.cn",n="".concat(a,"/visitormanager/intelligent/front/checkAndRegister?tenantId=").concat(tenant.tenantId,"&instance=").concat(tenant.bossProductInstance),i={account:localStorage.getItem("account_".concat(tenant.tenantId))};t.previewFlow&&(i.account=t.previewFlow),e.cmsAjax.postJson(n,i).then(function(n){200==n.status&&n.data&&!function(e){var t=!1,n=JSON.parse(e.colorLayout).linkObj,a=window.pageObj?pageObj.pageId:"";a&&n&&(e=n.P,!isMo()||1!=tenant.mobileStatus&&6!=tenant.mobileStatus&&11!=tenant.mobileStatus||(e=n.M),-1<e.findIndex(function(e){return e.pageId==a})&&(t=!0));return t}(n.data.setting)&&(t.previewFlow||localStorage.setItem("account_".concat(tenant.tenantId),n.data.account),$require(["css!/npublic/commonjs/smartService/t.css","/npublic/commonjs/smartService/smartService.js"],function(e,t){n.data.domain=a;new t(n.data)}))})}))})}function preventFish(){var e=location.hostname,t=getCookie("realhost")||"";t&&t!=e&&(t="/repository/cheat?req="+e+"&rel="+t,$.ajax({url:t}))}function wxShare(){$require(["cmsAjax","/npublic/commonjs/jweixin/jweixin.js","pl_util"],function(e){var t={pageUrl:location.href,appCode:pageObj.appId,tid:pageObj.contentType,pageType:pageObj.pageType,isHomePage:pageObj.isHomePage,pageId:pageObj.pageId,contentId:pageObj._detailId,pageName:pageObj.name};e.cmsAjax.postJson("/fwebapi/cms/api/tdk/getWxShareInfo",t).then(function(e){var t,n,a,i=e.data;i.data&&(i=i.data),i.wxJsConfig&&(t=i.wxJsConfig,a=i.wxShareContent,n={title:a.title,desc:a.desc,link:location.href,imgUrl:(e=$.handleDataImg(a.imgUrl),i=104,a=-1<e.indexOf("?")?e.split("?")[1]:"",e=e.split("?")[0],a=a?"?"+a:"",e+"_"+i+"xaf"+e.substr(e.lastIndexOf("."))+a)},wx.config({debug:!1,appId:t.appId,timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:["updateAppMessageShareData","updateTimelineShareData"]}),wx.ready(function(){wx.updateAppMessageShareData(n),wx.updateTimelineShareData(n)}))})})}$(function(){window.pageObj&&1==window.pageObj.isHomePage&&gray(),"portal-saas-mall"!=tenant.unittype&&(festival(),smartServiceInit()),268516!=tenant.tenantId&&"portal-saas-mall"!=tenant.unittype&&preventFish(),isWeixin()&&"portal-saas-mall"!=tenant.unittype&&wxShare(),"miniprogram"===window.__wxjs_environment&&$require(["/npublic/commonjs/jweixin/jweixin.js","pl_util"],function(){wx.miniProgram.postMessage({data:{shareTitle:encodeURIComponent(document.title),shareDesc:getmeta("description"),shareUrl:encodeURIComponent(location.href)}})}),accessLimit()});